angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","dateFilter","myConstant","DateCalculateService",function(e,t,a,n,r,o,y,d,c,i){function u(){var e=document.getElementById("queryForm");p.url=angular.element(e).prop("action"),p.postData=p.queryBean,p.postData.pageSize=p.pagination.pageSize,p.postData.pageNum=p.pagination.pageNum,p.postData.sDateStart=d(p.queryBean.oDateStart,"yyyyMMdd"),p.postData.sDateEnd=d(p.queryBean.oDateEnd,"yyyyMMdd"),p.postData.sHandleDateStart=d(p.queryBean.oHandleDateStart,"yyyyMMdd"),p.postData.sHandleDateEnd=d(p.queryBean.oHandleDateEnd,"yyyyMMdd"),t.post(p.url,a(p.postData)).then(function(e){var t=e.data;t.success?(p.pagination=t.object,p.sumObject=t.sumObject,o.clearChecked()):alert(t.msg)})}function s(){p.queryBean={oDateStart:i.getYesterday(),oDateEnd:i.getToday()}}function l(e,r){confirm("确认操作？")&&t.post("handle",a({id:e,handleType:r})).then(function(e){var t=e.data;t.success?(p.queryDetail(),alert("操作成功")):alert("操作失败:"+t.msg)},function(e){alert(e.statusText),n.debug("error")})}var p=e.vm={};p.constant=c,p.downCfg={contentType:"jqLike",date:{oDateStart:"yyyyMMdd",oDateEnd:"yyyyMMdd",oHandleDateStart:"yyyyMMddHHmmss",oHandleDateEnd:"yyyyMMddHHmmss"}},p.pagination={pageSize:10,pageNum:1},p.queryBean={oDateStart:i.getYesterday(),oDateEnd:i.getToday()},p.queryDetail=u,p.resetForm=s,p.handle=l,p.cached={MERCHANT_CODE:{}},y.initCache(p.cached),p.getCache=function(e){return y.getCache(e)},p.getObj=function(e,r){return t.post(config.ctx+"/base/cache/getAll",a({cacheKey:e})).then(function(e){return limitToFilter(filterFilter(e.data.object,r),6)},function(e){n.error("获取数据%s失败",cacheKey)})}}]);