angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","myConstant",function(e,t,a,n,c,i,l,o){function d(){var e=document.getElementById("queryForm");g.url=angular.element(e).prop("action");var n=g.queryBean;n.pageSize=g.pagination.pageSize,n.pageNum=g.pagination.pageNum,t.post(g.url,a(n)).then(function(e){var t=e.data;t.success?(g.pagination=t.object,i.clearChecked()):alert(t.msg)})}function r(){g.queryBean={},g.queryBean.companyType="02"}function u(e,t){i.updateChecked(e,t),n.debug(t),n.debug(i.getChecked())}function E(){c({modalTitle:"新增机构结算信息",modalBody:"toAdd",url:"add",item:{},cached:{COMANY_CODE:g.getCache("COMANY_CODE"),CLR_CYCLE:g.cached.CLR_CYCLE,REPORT_TYPE:g.cached.REPORT_TYPE,CLR_TYPE:g.cached.CLR_TYPE,FEE_CLEAR_TYPE:g.cached.FEE_CLEAR_TYPE,CLR_RANGE:g.cached.CLR_RANGE,CLEAR_VALUE_POINT:g.cached.CLEAR_VALUE_POINT,CLEAR_VALUE_POINT_WEEK:g.cached.CLEAR_VALUE_POINT_WEEK}},function(e){},"addInstiutionClearCfgApp","myModalNoFooter.html")}function C(e,a,c){var i={id:e.id};a&&(i.auditStatus=a),c&&(i.enableFlag=c),t.post(config.ctx+"/merchant/clearCfg/updateItemEnableFlag",i,config.jsonHeader).then(function(t){var n=t.data;n.success?(a&&(e.auditStatus=a),c&&(e.enableFlag=c),alert("操作成功"),g.queryDetail()):alert("操作失败")},function(e){alert(e.statusText),n.debug("error")})}function s(){if(1!=i.getChecked().length)return void alert("必须勾选一条记录！");var e=g.pagination.list.filter(function(e,t,a){return e.id==i.getChecked()[0]})[0];e.createTime=null,e.lastUpdTime=null,e.auditDate=null,c({modalTitle:"修改机构结算信息",modalBody:"toUpdate",url:"update",item:e,cached:{COMANY_CODE:g.getCache("COMANY_CODE"),CLR_CYCLE:g.cached.CLR_CYCLE,REPORT_TYPE:g.cached.REPORT_TYPE,CLR_TYPE:g.cached.CLR_TYPE,FEE_CLEAR_TYPE:g.cached.FEE_CLEAR_TYPE,CLR_RANGE:g.cached.CLR_RANGE,CLEAR_VALUE_POINT:g.cached.CLEAR_VALUE_POINT,CLEAR_VALUE_POINT_WEEK:g.cached.CLEAR_VALUE_POINT_WEEK}},function(e){},"updateInstiutionClearCfgApp","myModalNoFooter.html")}function _(){return 1!=i.getChecked().length?void alert("必须勾选一条记录！"):void t.post("delete",a({id:i.getChecked()[0]})).then(function(e){var t=e.data;if(t.success){var a=g.pagination.list.filter(function(e,t,a){return e.id==i.getChecked()[0]})[0];g.pagination.list.splice(g.pagination.list.indexOf(a),1),alert("操作成功")}else alert("操作失败")},function(e){alert(e.statusText),n.debug("error")})}var g=e.vm={};g.constant=o,g.pagination={pageSize:10,pageNum:1},g.queryBean={},g.queryDetail=d,g.resetForm=r,g.updateChecked=u,g.addItem=E,g.updateItem=s,g.deleteItem=_,g.updateItemEnableFlag=C,g.cached={COMANY_CODE:{},CLR_CYCLE:{},REPORT_TYPE:{},CLR_TYPE:{},FEE_CLEAR_TYPE:{},ENABLE_FLAG:{},CLR_RANGE:{},CLEAR_VALUE_POINT:{},CLEAR_VALUE_POINT_WEEK:{}},l.initCache(g.cached),g.getCache=function(e){return l.getCache(e)}}]),angular.module("myApp").controller("addInstiutionClearCfgApp",function(e,t,a,n,c,i,l){console.log("test");var o=e.vm={modalTitle:"please change the title",modalBody:"#",url:"",item:{}};o=e.vm=a,o.constant=l,e.save=function(){var e=o.item;i.debug("postData---------",e,"--------postData"),n.post(o.url,e,config.jsonHeader).then(function(e){e.data.success?(alert("操作成功"),t.close(o.item)):""!=e.data.msg?alert(e.data.msg):alert("新增失败")},function(e){alert("操作失败"),alert(e.status)})},e.cancel=function(){t.dismiss("cancel")}}),angular.module("myApp").controller("updateInstiutionClearCfgApp",function(e,t,a,n,c,i,l){var o=e.vm={modalTitle:"please change the title",modalBody:"#",url:"",item:{}};o=e.vm=a,o.constant=l,e.save=function(){var e=o.item;delete e.clearKey,delete e.$$hashKey,i.debug("postDate:",e),n.post(o.url,e,config.jsonHeader).then(function(e){e.data.success?(alert("操作成功"),t.close(o.item)):""!=e.data.msg?alert(e.data.msg):alert("新增失败")},function(e){alert("操作失败"),alert(e.status)})},e.cancel=function(){t.dismiss("cancel")}});