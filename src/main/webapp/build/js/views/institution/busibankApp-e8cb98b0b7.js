angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","myConstant",function(e,n,t,a,o,r,s,i){function l(){var e=document.getElementById("queryForm");g.url=angular.element(e).prop("action"),g.postData=g.queryBean,g.postData.pageSize=g.pagination.pageSize,g.postData.pageNum=g.pagination.pageNum,n.post(g.url,t(g.postData)).then(function(e){var n=e.data;n.success?(g.pagination=n.object,null==g.pagination.list||0==g.pagination.list.length?(g.pagination={pageSize:10,pageNum:1},document.getElementById("busi_bank_tr").style.display=""):document.getElementById("busi_bank_tr").style.display="none",r.clearChecked()):(alert(n.msg),document.getElementById("busi_bank_tr").style.display="")})}function c(){g.queryBean={}}function u(){o({modalTitle:"业务资金源配置修改或新增",modalBody:"toAdd",url:"toAdd",cached:{BUSINESS_FUNDING_SOURCE:g.cached.BUSINESS_FUNDING_SOURCE,BANK_TYPE:s.getCache("BANK_TYPE"),CONN_CHANNEL:s.getCache("CONN_CHANNEL")}},function(e){g.queryDetail()},"busiBankModalInstanceCtrl","myModalNoFooter.html")}var g=e.vm={};g.constant=i,g.pagination={pageSize:10,pageNum:1},g.queryBean={},g.queryDetail=l,g.resetForm=c,g.addItem=u,g.queryOrgBankInfo=g.queryOrgBankInfo,g.cached={BANK_TYPE:{},CONN_CHANNEL:{},BUSINESS_FUNDING_SOURCE:{}},s.initCache(g.cached),g.getBusiDesc=function(e,n){return n+"("+e+")"}}]),angular.module("myApp").controller("busiBankModalInstanceCtrl",["$scope","$uibModalInstance","modalItem","$http","$httpParamSerializerJQLike","myConstant",function(e,n,t,a,o,r){var s=e.vm={modalTitle:"please change the title",modalBody:"#",url:"",item:{}};s=e.vm=t,s.constant=r,s.orgBanks=new Array,s.queryBean={},e.save=function(){s.url=config.ctx+"/institution/busiBank/saveBusiBank";var n={headers:{"Content-Type":"application/json"}};a.post(s.url,s.orgBanks,n).then(function(n){var t=n.data;t.success?e.cancel():(alert(t.msg),e.cancel())})},e.cancel=function(){n.dismiss("cancel")},s.getBankType=function(e){for(var n=s.cached.BANK_TYPE,t=new Array,a=0,o=0;o<n.length;o++){var r=n[o].key;r.substr(0,e.length)==e&&(t[a]=n[o],a++)}s.bankTypes=t,s.orgBanks=new Array,document.getElementById("orgBanks").style.display="none",document.getElementById("busi_propmt").style.display="none"},s.updateChecked=function(e,n){var t=e.target;if(t.checked)for(var a=0;a<s.orgBanks.length;a++)s.orgBanks[a].bankCode==n&&(s.orgBanks[a].choose="1");else for(var a=0;a<s.orgBanks.length;a++)s.orgBanks[a].bankCode==n&&(s.orgBanks[a].choose="0")},s.chooseAll=function(e){var n=e.target;if(n.checked)for(var t=0;t<s.orgBanks.length;t++)s.orgBanks[t].choose="1";else for(var t=0;t<s.orgBanks.length;t++)s.orgBanks[t].choose="0"},s.getBusiBankInfo=function(e){return s.url=config.ctx+"/institution/busiBank/getBusiBankInfo",null==s.queryBean.busiType||""==s.queryBean.busiType?void(document.getElementById("busi_propmt").style.display=""):(s.postData={bankType:e,busiType:s.queryBean.busiType},void a.post(s.url,o(s.postData)).then(function(e){var n=e.data;n.success?(0==n.object.length?document.getElementById("orgBanks").style.display="none":document.getElementById("orgBanks").style.display="block",s.orgBanks=n.object):(document.getElementById("orgBanks").style.display="none",alert(n.msg))}))},s.getBusiDesc=function(e,n){return n+"("+e+")"}}]);