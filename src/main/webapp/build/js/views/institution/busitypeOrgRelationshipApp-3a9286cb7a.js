angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","myConstant","dateFilter",function(e,t,a,n,i,c,o,r,d){function u(){var e=document.getElementById("queryForm");p.url=angular.element(e).prop("action"),p.postData=p.queryBean,p.postData.pageSize=p.pagination.pageSize,p.postData.pageNum=p.pagination.pageNum,t.post(p.url,a(p.postData)).then(function(e){var t=e.data;t.success?(p.pagination=t.object,c.clearChecked()):alert(t.msg)})}function l(){p.queryBean={}}function N(e,t){c.updateChecked(e,t),n.debug(t),n.debug(c.getChecked())}function g(){i({modalTitle:"新增强绑关系",modalBody:"toAdd",url:"add",item:{},cached:{COMANY_CODE:o.getCache("COMANY_CODE"),BUSINESS_FUNDING_SOURCE:o.getCache("BUSINESS_FUNDING_SOURCE"),BANK_TYPE:o.getCache("BANK_TYPE"),BANK_INFO:o.getCache("BANK_INFO"),ENABLE_FLAG:o.getCache("ENABLE_FLAG")}},function(e){},"","myModalNoFooter.html")}function C(){if(1!=c.getChecked().length)return void alert("必须勾选一条记录！");var e=p.pagination.list.filter(function(e,t,a){return e.id==c.getChecked()[0]})[0];e.createTime=d(e.createTime,"yyyyMMdd"),e.lastUpdTime=d(e.lastUpdTime,"yyyyMMdd"),i({modalTitle:"修改强绑关系",modalBody:"toUpdate",url:"update",item:e,cached:{COMANY_CODE:o.getCache("COMANY_CODE"),BUSINESS_FUNDING_SOURCE:o.getCache("BUSINESS_FUNDING_SOURCE"),BANK_TYPE:o.getCache("BANK_TYPE"),BANK_INFO:o.getCache("BANK_INFO"),ENABLE_FLAG:o.getCache("ENABLE_FLAG")}},function(){},"","myModalNoFooter.html")}function h(){return 1!=c.getChecked().length?void alert("必须勾选一条记录！"):void t.post("delete",a({id:c.getChecked()[0]})).then(function(e){var t=e.data;if(t.success){var a=p.pagination.list.filter(function(e,t,a){return e.userId==c.getChecked()[0]})[0];p.pagination.list.splice(p.pagination.list.indexOf(a),1),alert("操作成功")}else alert("操作失败")},function(e){alert(e.statusText),n.debug("error")})}var p=e.vm={};p.constant=r,p.pagination={pageSize:10,pageNum:1},p.queryBean={},p.queryDetail=u,p.resetForm=l,p.updateChecked=N,p.addItem=g,p.updateItem=C,p.deleteItem=h,p.cached={COMANY_CODE:{},BUSINESS_FUNDING_SOURCE:{},BANK_INFO:{},BANK_TYPE:{},ENABLE_FLAG:{}},o.initCache(p.cached),p.getCache=function(e){return o.getCache(e)}}]);