angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","limitToFilter","filterFilter","dateFilter","myConstant",function(e,a,t,n,l,o,i,c,r,u,d){function m(){var e=document.getElementById("queryForm");g.url=angular.element(e).prop("action"),g.pagination.queryBean=g.queryBean;var t=g.pagination;a.post(g.url,t,config.jsonHeader).then(function(e){var a=e.data;a.success?(g.pagination=a.object,o.clearChecked()):alert(a.msg)})}function f(){g.queryBean={busiType:"B1"},g.pagination.queryBean={}}function s(){l({modalTitle:"上传文件",modalBody:"toAdd",url:"add",item:{},cached:{COMANY_CODE:g.getCache("COMANY_CODE")}},function(e){},"uploadReserveModalInstanceCtrl","myModalNoSave.html")}function p(e){location.href=config.ctx+"/base/dfsFileInfo/download?dfsGroupname="+e.dfsGroupname+"&dfsFullFilename="+e.dfsFullFilename+"&localFilename="+e.localFilename}var g=e.vm={};g.constant=d,g.pagination={pageSize:10,pageNum:1},g.queryBean={},g.cached={ALL_COMPANY_CODE:{},UPLOAD_STATUS:{},DOCUMENT_TYPE:{},ALL_COMPANY_CODE:{}},i.initCache(g.cached),g.getCache=function(e){return i.getCache(e)},g.getObj=function(e,l){return a.post(config.ctx+"/base/cache/getAll",t({cacheKey:e})).then(function(e){return c(r(e.data.object,l),6)},function(e){n.error("获取数据%s失败",cacheKey)})},g.queryDetail=m,g.resetForm=f,g.upload=s,g.downFile=p}]),angular.module("myApp").controller("uploadReserveModalInstanceCtrl",["$scope","$uibModalInstance","modalItem","$http","$httpParamSerializerJQLike","FileUploader","$log","myConstant",function(e,a,t,n,l,o,i,c){function r(){return u.item.companyCode&&u.item.bankSettleDate?(u.file1.companyCode=u.item.companyCode,u.file1.bankSettleDate=u.item.bankSettleDate,u.file1.id?void n.post(config.ctx+"/orgCheckFile/add",u.file1,config.jsonHeader).then(function(a){var t=a.data;t.success?(alert("提交成功"),e.cancel()):alert(t.msg)}):(alert("请先上传文件"),!1)):(alert("请先选择备付金银行"),!1)}var u=e.vm={modalTitle:"please change the title",modalBody:"#",url:"",item:{}};u=e.vm=t,u.constant=c,u.file1={},u.fileUploader=new o({url:config.ctx+"/system/fileUploader/upload",formData:[{busiType:"TP",remark:"支付机构对账文件"}],filters:[{name:"limitItem",fn:function(e){return!(u.fileUploader.queue.length>=1)||(alert("请先取消原先文件,再选择新文件!"),!1)}}]}),u.fileUploader.onSuccessItem=function(e,a,t,n){u.file1={localFilename:a.object.localFilename,dfsFullFilename:a.object.dfsFullFilename,dfsGroupName:a.object.dfsGroupName,id:a.object.id}},u.fileUploader.onCancelItem=function(e,a,t,n){u.file1={}},u.uploadBean={},u.uploadFile=r,e.save=function(){},e.cancel=function(){a.dismiss("cancel")}}]);