angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","myConstant",function(e,t,a,n,i,o,c,r){function d(){var e=document.getElementById("queryForm");h.url=angular.element(e).prop("action"),h.postData=h.queryBean,h.postData.pageSize=h.pagination.pageSize,h.postData.pageNum=h.pagination.pageNum,t.post(h.url,a(h.postData)).then(function(e){var t=e.data;t.success?(h.pagination=t.object,o.clearChecked()):alert(t.msg)})}function l(){h.queryBean={}}function u(e,t){o.updateChecked(e,t),n.debug(t),n.debug(o.getChecked())}function g(){i({modalTitle:"新增联系人信息",modalBody:"toAdd",url:"add",item:{},cached:{CTT_TYPE:c.getCache("CTT_TYPE"),COMANY_CODE:c.getCache("COMANY_CODE")}},function(e){},"","myModalNoFooter.html")}function C(){if(1!=o.getChecked().length)return void alert("必须勾选一条记录！");var e=h.pagination.list.filter(function(e,t,a){return e.id==o.getChecked()[0]})[0];e.createTime=null,e.lastUpdTime=null,i({modalTitle:"修改联系人信息",modalBody:"toUpdate",url:"update",item:e,cached:{CTT_TYPE:c.getCache("CTT_TYPE"),COMANY_CODE:c.getCache("COMANY_CODE")}},function(){},"","myModalNoFooter.html")}function p(){return 1!=o.getChecked().length?void alert("必须勾选一条记录！"):void t.post("delete",a({id:o.getChecked()[0]})).then(function(e){var t=e.data;if(t.success){var a=h.pagination.list.filter(function(e,t,a){return e.id==o.getChecked()[0]})[0];h.pagination.list.splice(h.pagination.list.indexOf(a),1),alert("操作成功")}else alert("操作失败")},function(e){alert(e.statusText),n.debug("error")})}var h=e.vm={};h.constant=r,h.pagination={pageSize:10,pageNum:1},h.queryBean={},h.queryDetail=d,h.resetForm=l,h.updateChecked=u,h.addItem=g,h.updateItem=C,h.deleteItem=p,h.getCache=function(e){return c.getCache(e)},h.cached={CTT_TYPE:{},CTT_STATUS:{},COMANY_CODE:{},ORG_TYPE:{}},c.initCache(h.cached)}]);