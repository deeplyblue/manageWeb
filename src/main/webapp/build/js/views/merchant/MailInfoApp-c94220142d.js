angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","myConstant",function(e,t,a,n,o,i,c,r){function l(){var e=document.getElementById("queryForm");C.url=angular.element(e).prop("action"),C.postData=C.queryBean,C.postData.pageSize=C.pagination.pageSize,C.postData.pageNum=C.pagination.pageNum,t.post(C.url,a(C.postData)).then(function(e){var t=e.data;t.success?(C.pagination=t.object,i.clearChecked()):alert(t.msg)})}function d(){C.queryBean={}}function u(e,t){i.updateChecked(e,t),n.debug(t),n.debug(i.getChecked())}function s(){o({modalTitle:"新增",modalBody:"toAdd",url:"add",item:{},cached:{COMANY_CODE:c.getCache("COMANY_CODE"),COMMON_VALUE:c.getCache("COMMON_VALUE"),ALL_CITY:C.cached.ALL_CITY}},function(e){},"","myModalNoFooter.html")}function p(){if(1!=i.getChecked().length)return void alert("必须勾选一条记录！");var e,t,a=C.pagination.list.filter(function(a,n,o){if(a.id==i.getChecked()[0])return console.debug(a.areaCode),e=C.cached.ALL_CITY.filter(function(e){if(a.areaCode&&e.areaCode==a.areaCode)return!0})[0],t=e.citys.filter(function(e){if(a.cityCode&&e.cityCode==a.cityCode)return!0})[0],!0})[0];o({modalTitle:"修改",modalBody:"toUpdate",url:"update",item:a,pro:e,city:t,cached:{ALL_CITY:C.cached.ALL_CITY}},function(e){},"updateMailInfoInstanceCtrl","myModalNoFooter.html")}function m(){return 1!=i.getChecked().length?void alert("必须勾选一条记录！"):void t.post("delete",a({id:i.getChecked()[0]})).then(function(e){var t=e.data;if(t.success){var a=C.pagination.list.filter(function(e,t,a){return e.id==i.getChecked()[0]})[0];C.pagination.list.splice(C.pagination.list.indexOf(a),1),alert("操作成功")}else alert("操作失败")},function(e){alert(e.statusText),n.debug("error")})}var C=e.vm={};C.constant=r,C.pagination={pageSize:10,pageNum:1},C.queryBean={},C.queryDetail=l,C.resetForm=d,C.updateChecked=u,C.addItem=s,C.updateItem=p,C.deleteItem=m,C.cached={COMANY_CODE:{},COMMON_VALUE:{}},function(){c.initCache(C.cached),c.getObj("ALL_CITY",function(e,t){n.debug(t),C.cached.ALL_CITY=t})}(),C.getCache=function(e){return c.getCache(e)}}]),angular.module("myApp").controller("updateMailInfoInstanceCtrl",["$scope","$uibModalInstance","modalItem","$http","$httpParamSerializerJQLike","$log","dateFilter","myConstant",function(e,t,a,n,o,i,c,r){var l=e.vm={modalTitle:"please change the title",modalBody:"#",url:"",item:{}};l=e.vm=a,l.constant=r,e.save=function(){l.postData=angular.copy(l.item),l.postData.createTime=null,l.postData.lastUpdTime=null,i.debug(l.postData),n.post(l.url,o(l.postData)).then(function(e){e.data.success?(alert("操作成功"),t.close(l.item)):alert(e.data.msg)},function(e){alert("操作失败"),alert(e.status)})},e.cancel=function(){t.dismiss("cancel")}}]);