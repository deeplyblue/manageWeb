angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","limitToFilter","filterFilter","myConstant",function(e,t,a,n,i,o,c,r,l,u){function d(){var e=document.getElementById("queryForm");s.url=angular.element(e).prop("action"),s.postData=s.queryBean,s.postData.pageSize=s.pagination.pageSize,s.postData.pageNum=s.pagination.pageNum,t.post(s.url,a(s.postData)).then(function(e){var t=e.data;t.success?(s.pagination=t.object,o.clearChecked()):alert(t.msg)})}function g(){s.queryBean={}}function C(e,t){o.updateChecked(e,t),n.debug(t),n.debug(o.getChecked())}function p(){i({modalTitle:"新增",modalBody:"toAdd",url:"add",item:{},cached:{COMANY_CODE:c.getCache("COMANY_CODE"),TRANS_CODE_02:c.getCache("TRANS_CODE_02"),BANK_TYPE:c.getCache("BANK_TYPE")}},function(e){s.pagination.list.push(e)},"","myModalNoFooter.html")}function h(){if(1!=o.getChecked().length)return void alert("必须勾选一条记录！");var e=s.pagination.list.filter(function(e,t,a){return e.id==o.getChecked()[0]})[0];e.createTime=null,e.lastUpdTime=null,e.auditDate=null,i({modalTitle:"修改",modalBody:"toUpdate",url:"update",item:e,cached:{COMANY_CODE:c.getCache("COMANY_CODE"),TRANS_CODE_02:c.getCache("TRANS_CODE_02"),BANK_TYPE:c.getCache("BANK_TYPE")}},function(){},"","myModalNoFooter.html")}function m(){return 1!=o.getChecked().length?void alert("必须勾选一条记录！"):void t.post("delete",a({id:o.getChecked()[0]})).then(function(e){var t=e.data;if(t.success){var a=s.pagination.list.filter(function(e,t,a){return e.id==o.getChecked()[0]})[0];s.pagination.list.splice(s.pagination.list.indexOf(a),1),alert("操作成功")}else alert("操作失败")},function(e){alert(e.statusText),n.debug("error")})}var s=e.vm={};s.constant=u,s.pagination={pageSize:10,pageNum:1},s.queryBean={},s.queryDetail=d,s.resetForm=g,s.updateChecked=C,s.addItem=p,s.updateItem=h,s.deleteItem=m,s.cached={COMANY_CODE:{},TRANS_CODE_02:{},BANK_TYPE:{},TRANS_CODE:{}},c.initCache(s.cached),s.getCache=function(e){return c.getCache(e)}}]);