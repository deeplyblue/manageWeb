angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","DateCalculateService","OpenService","CheckboxService","CacheService","dateFilter","myConstant",function(e,t,a,i,n,o,d,r,c,l){function u(){var e=document.getElementById("queryForm");y.url=angular.element(e).prop("action");var i=angular.copy(y.queryBean);i.pageSize=y.pagination.pageSize,i.pageNum=y.pagination.pageNum,i.createTime=c(i.createTime,"yyyyMMdd"),i.lastUpdTime=c(i.lastUpdTime,"yyyyMMdd"),t.post(y.url,a(i)).then(function(e){var t=e.data;t.success?(y.pagination=t.object,d.clearChecked()):alert(t.msg)})}function g(){y.queryBean={}}function p(e,t){d.updateChecked(e,t),i.debug(t),i.debug(d.getChecked())}function m(){o({modalTitle:"添加响应码",modalBody:"toAdd",url:"add",item:{},cached:{}},function(e){u()},"","myModalNoFooter.html")}function s(){if(1!=d.getCheckedNew(y.pagination.list).length)return void alert("必须勾选一条记录！");var e=d.getCheckedNew(y.pagination.list)[0];e.createTime=null,e.lastUpdTime=null,o({modalTitle:"修改响应码",modalBody:"toUpdate",url:"update",item:e,cached:{}})}function h(){return 1!=d.getCheckedNew(y.pagination.list).length?void alert("必须勾选一条记录！"):void t.post("delete",a({id:d.getCheckedNew(y.pagination.list)[0].id})).then(function(e){var t=e.data;t.success?(y.pagination.list.splice(y.pagination.list.indexOf(d.getCheckedNew(y.pagination.list)[0]),1),alert("操作成功")):alert("操作失败")},function(e){alert(e.statusText),i.debug("error")})}var y=e.vm={};y.constant=l,y.pagination={pageSize:10,pageNum:1},y.queryBean={createTime:n.getToday(),lastUpdTime:n.getTomorrow()},y.queryDetail=u,y.resetForm=g,y.updateChecked=p,y.addItem=m,y.updateItem=s,y.deleteItem=h,y.cached={T_USER_DOWNLOAD:{}},r.initCache(y.cached),y.getCache=function(e){return r.getCache(e)}}]);