angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","limitToFilter","filterFilter","dateFilter","myConstant","DateCalculateService",function(e,t,a,n,o,r,i,c,u,d,p,y){function D(){document.getElementById("queryForm");l.url=config.ctx+"/refund/queryRefundList",l.postData=angular.copy(l.queryBean),l.postData.pageSize=l.pagination.pageSize,l.postData.pageNum=l.pagination.pageNum,l.postData.refundBeginDate=d(l.postData.refundBeginDate,"yyyyMMdd"),l.postData.refundEndDate=d(l.postData.refundEndDate,"yyyyMMdd"),l.postData.auditBeginDate=d(l.postData.auditBeginDate,"yyyyMMdd"),l.postData.auditEndDate=d(l.postData.auditEndDate,"yyyyMMdd"),l.postData.proBeginDate=d(l.postData.proBeginDate,"yyyyMMdd"),l.postData.proEndDate=d(l.postData.proEndDate,"yyyyMMdd"),t.post(l.url,a(l.postData)).then(function(e){var t=e.data;t.success?(l.pagination=t.object,l.sumObject=t.sumObject):alert(t.msg)})}function s(){l.queryBean={}}function g(e){confirm("确认发起退款？")&&t.post(config.ctx+"/refund/onlineRefund",a({id:e})).then(function(e){var t=e.data;t.success?(alert("处理成功"),D()):(alert(t.msg),l.queryDetail())})}var l=e.vm={};l.constant=p,l.pagination={pageSize:10,pageNum:1},l.queryBean={refundBeginDate:y.getYesterday(),refundEndDate:y.getToday()},l.cached={ORDER_STATUS:{},CONN_CHANNEL:{},REFUND_TYPE:{},REFUND_STATUS:{},MERCHANT_CODE:{},COMANY_CODE:{}},i.initCache(l.cached),l.getCache=function(e){return i.getCache(e)},l.getObj=function(e,o){return t.post(config.ctx+"/base/cache/getAll",a({cacheKey:e})).then(function(e){return c(u(e.data.object,o),6)},function(e){n.error("获取数据%s失败",cacheKey)})},l.queryDetail=D,l.resetForm=s,l.onlineRefund=g}]);