angular.module("myApp").controller("queryCtrl",["$scope","$http","$httpParamSerializerJQLike","$log","OpenService","CheckboxService","CacheService","limitToFilter","filterFilter","dateFilter","myConstant","DateCalculateService",function(e,t,n,a,r,c,o,i,u,l,g,d){function p(){var e=document.getElementById("queryForm");h.url=angular.element(e).prop("action"),h.pagination.queryBean=h.queryBean;var n=h.pagination;t.post(h.url,n,config.jsonHeader).then(function(e){var t=e.data;t.success?(h.pagination=t.object,h.sumObject=t.sumObject,c.clearChecked()):alert(t.msg)})}function s(){h.queryBean={}}function f(e){t.post(config.ctx+"/mchntplatform/mchntRefund/refundApply",n({ourTransNo:e})).then(function(e){var t=e.data;t.success&&(alert("申请成功"),h.queryDetail())},function(e){alert("申请失败"),h.queryDetail()})}var h=e.vm={};h.constant=g,h.pagination={pageSize:10,pageNum:1},h.cached={MERCHANT_CODE:{}},o.initCache(h.cached),h.getCache=function(e){return o.getCache(e)},h.getObj=function(e,r){return t.post(config.ctx+"/base/cache/getAll",n({cacheKey:e})).then(function(e){return i(u(e.data.object,r),6)},function(e){a.error("获取数据%s失败",cacheKey)})},h.queryDetail=p,h.resetForm=s;var m={beginOrderDate:d.getToday(),endOrderDate:d.getToday()};h.queryBean=m,h.doRefund=f}]);