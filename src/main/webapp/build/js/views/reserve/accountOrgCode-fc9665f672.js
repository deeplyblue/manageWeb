angular.module("myApp").controller("queryCtrl",function(e,t,a,n,c,i,o,r,u,d,g){function l(){R.cached.RESERVE_LIST=[];for(var e in R.cached.RESERVE_INFO)R.cached.RESERVE_LIST.push({accountNo:e,desc:R.cached.RESERVE_INFO[e].description})}function s(){var e=document.getElementById("queryForm");R.url=angular.element(e).prop("action");var n=angular.copy(R.queryBean);n.pageSize=R.pagination.pageSize,n.pageNum=R.pagination.pageNum,t.post(R.url,a(n)).then(function(e){var t=e.data;t.success?(R.pagination=t.object,i.clearChecked()):alert(t.msg)})}function p(){R.queryBean={}}function h(e,t){i.updateChecked(e,t),n.debug(t),n.debug(i.getChecked())}function E(){c({modalTitle:"新增备付金账户机构",modalBody:"toAdd",url:"add",item:{},cached:{RESERVE_LIST:R.cached.RESERVE_LIST}},function(e){R.pagination.list.push(e)})}function f(){if(1!=i.getCheckedNew(R.pagination.list).length)return void alert("必须勾选一条记录！");var e=i.getCheckedNew(R.pagination.list)[0];c({modalTitle:"修改备付金账户机构",modalBody:"toUpdate",url:"update",item:e,cached:{}},function(e){n.debug(e)})}function m(){if(1!=i.getCheckedNew(R.pagination.list).length)return void alert("必须勾选一条记录！");if(confirm("是否确认删除！")){var e=i.getCheckedNew(R.pagination.list)[0];t.post("delete",a(e)).then(function(t){var a=t.data;a.success?(R.pagination.list.splice(R.pagination.list.indexOf(e),1),alert("操作成功")):alert("操作失败")},function(e){alert(e.statusText),n.debug("error")})}}var R=e.vm={};R.constant=g,R.pagination={pageSize:10,pageNum:1},R.queryBean={},R.cached={RESERVE_LIST:{},RESERVE_INFO:{}},R.cachedTemp={COMANY_CODE:{},MERCHANT_CODE:{}},function(){o.initCache(R.cachedTemp),R.queryBean={},t.post(config.ctx+"/reserve/info/init/reserve",{},config.jsonHeader).then(function(e){e.data.success?(R.cached.RESERVE_INFO=e.data.object,l()):n.error("获取数据%s失败",e.data.msg)},function(e){n.error("获取数据%s失败",cacheKey)})}(),R.getCache=function(e){return o.getCache(e)},R.getObj=function(e,c){return t.post(config.ctx+"/base/cache/getAll",a({cacheKey:e})).then(function(e){return r(u(e.data.object,c),6)},function(e){n.error("获取数据%s失败",cacheKey)})},R.queryDetail=s,R.resetForm=p,R.updateChecked=h,R.addItem=E,R.updateItem=f,R.deleteItem=m});