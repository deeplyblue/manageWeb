angular.module("myApp").controller("queryCtrl",function(e,t,a,n,o,c,r,l,i,u,d){function s(){var e=document.getElementById("queryForm");g.url=angular.element(e).prop("action"),g.queryBean.clrType="02",g.postData=angular.copy(g.queryBean),g.postData.pageSize=g.pagination.pageSize,g.postData.pageNum=g.pagination.pageNum,g.postData.beginDate=u(g.postData.beginDate,"yyyyMMdd"),g.postData.endDate=u(g.postData.endDate,"yyyyMMdd"),t.post(g.url,a(g.postData)).then(function(e){var t=e.data;t.success?(g.pagination=t.object,g.sumObject=t.sumObject,c.clearChecked()):alert(t.msg)})}function p(){g.queryBean={}}function y(e){n.debug("bean.payOrgCode:",e.payOrgCode);var c;g.url=config.ctx+"/settlement/clear/detail/mchntClearDetail/getMchntClearDay",g.postData={},g.postData.payOrgCode=e.payOrgCode,g.postData.orgCode=e.orgCode,g.postData.settleDateBegin=u(e.settleDateBegin,"yyyyMMdd"),g.postData.settleDateEnd=u(e.settleDateEnd,"yyyyMMdd"),n.debug("postData:",g.postData),t.post(g.url,a(g.postData)).then(function(e){var t=e.data;t.success?(c=t.object.list,o({modalTitle:"商户本金结算查询-日结",modalBody:"redirectMchntClearDay",url:"allocate",item:{results:c},cached:g.cached},function(e){n.debug(e)},"MchntClearDayModalInstanceCtrl")):alert(t.msg)})}var g=e.vm={};g.constant=d,g.downCfg={contentType:"jqLike",date:{beginDate:"yyyyMMdd",endDate:"yyyyMMdd"}},g.pagination={pageSize:10,pageNum:1},g.sumObject={},g.queryBean={},g.queryBean.beginDate=new Date,g.queryBean.endDate=new Date,g.cached={BANK_INFO:{},BANK_CARD_TYPE:{},CONN_CHANNEL:{},TRANS_CODE_ALL:{},CLR_FLAG:{},CLR_TYPE:{},MERCHANT_CODE:{},COMANY_CODE:{}},r.initCache(g.cached),g.getCache=function(e){return r.getCache(e)},g.getObj=function(e,o){return t.post(config.ctx+"/base/cache/getAll",a({cacheKey:e})).then(function(e){return l(i(e.data.object,o),6)},function(e){n.error("获取数据%s失败",cacheKey)})},g.queryDetail=s,g.resetForm=p,g.redirectMchntClearDay=y}),angular.module("myApp").controller("MchntClearDayModalInstanceCtrl",function(e,t,a,n,o,c){function r(e,t){return 1==t&&1==i.detailFlag?void(i.detailFlag=!1):(i.detailFlag=!0,i.url=config.ctx+"/settlement/clear/detail/mchntClearDetail/redirectMchntSettleDetail",i.postData={},i.postData.orgCode=e.orgCode,i.postData.settleDate=o(e.settleDate,"yyyyMMdd"),i.postData.pageSize=i.pagination.pageSize,i.postData.pageNum=i.pagination.pageNum,void n.post(i.url,c(i.postData)).then(function(t){var a=t.data;a.success?(i.pagination=a.object,i.sumObject=a.sumObject,i.queryBean=e):alert(a.msg)}))}function l(){r(i.queryBean,!1)}var i=e.vm={modalTitle:"please change the title",modalBody:"#",url:"",item:{}};i=e.vm=a,i.pagination={pageSize:10,pageNum:1},i.sumObject={},e.save=function(){},e.cancel=function(){t.dismiss("cancel")},i.redirectMchntSettleDetail=r,i.queryDetail=l});